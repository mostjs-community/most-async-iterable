{"version":3,"file":"index.es.js","sources":["../src/asyncIterable.js","../src/source/AsyncIteratorProducer.js","../src/source/fromAsyncIterable.js","../src/source/asyncGenerate.js","../src/index.js"],"sourcesContent":["export function getAsyncIterator (asyncIterable) {\n  if (!Symbol.asyncIterator) {\n    throw new TypeError('Symbol.asyncIterator is not defined.')\n  }\n  return asyncIterable[Symbol.asyncIterator]()\n}\n\n","/** @license MIT License (c) copyright 2016 original author or authors */\n\nexport default function AsyncIteratorProducer (asyncIterator, sink, scheduler) {\n  this.asyncIterator = asyncIterator\n  this.sink = sink\n  this.scheduler = scheduler\n  this.active = true\n\n  var self = this\n  function err (e) {\n    self.sink.error(self.scheduler.now(), e)\n  }\n\n  Promise.resolve(this).then(stepProducer).catch(err)\n}\n\nAsyncIteratorProducer.prototype.dispose = function () {\n  this.active = false\n}\n\nfunction stepProducer (producer) {\n  return producer.asyncIterator.next().then(function (r) {\n    if (r.done) {\n      producer.sink.end(producer.scheduler.now(), r.value)\n    } else {\n      producer.sink.event(producer.scheduler.now(), r.value)\n      if (producer.active) {\n        return stepProducer(producer)\n      }\n    }\n  })\n}\n\n","import { Stream } from 'most'\nimport { getAsyncIterator } from '../asyncIterable.js'\nimport AsyncIteratorProducer from './AsyncIteratorProducer'\n\nexport function fromAsyncIterable (asyncIterable) {\n  return new Stream(new AsyncIterableSource(asyncIterable))\n}\n\nfunction AsyncIterableSource (asyncIterable) {\n  this.asyncIterable = asyncIterable\n}\n\nAsyncIterableSource.prototype.run = function (sink, scheduler) {\n  var asyncIterator = getAsyncIterator(this.asyncIterable)\n  return new AsyncIteratorProducer(asyncIterator, sink, scheduler)\n}\n\n","import { Stream } from 'most'\nimport { getAsyncIterator } from '../asyncIterable'\nimport AsyncIteratorProducer from './AsyncIteratorProducer'\n\n/**\n * Compute a stream using an *async* generator\n * @param f\n * @returns {Stream}\n */\nexport function asyncGenerate (f /*, ...args */) {\n  var args = Array.prototype.slice.call(arguments)\n  args.shift()\n  return new Stream(new AsyncGenerateSource(f, args))\n}\n\nfunction AsyncGenerateSource (f, args) {\n  this.f = f\n  this.args = args\n}\n\nAsyncGenerateSource.prototype.run = function (sink, scheduler) {\n  var asyncIterable = this.f.apply(void 0, this.args)\n  var asyncIterator = getAsyncIterator(asyncIterable)\n  return new AsyncIteratorProducer(asyncIterator, sink, scheduler)\n}\n","/** @license MIT License (c) copyright 2016 original author or authors */\n\nexport { fromAsyncIterable } from './source/fromAsyncIterable'\nexport { asyncGenerate } from './source/asyncGenerate'\n\n"],"names":["getAsyncIterator","asyncIterable","Symbol","asyncIterator","TypeError","AsyncIteratorProducer","sink","scheduler","active","self","err","e","error","now","resolve","then","stepProducer","catch","prototype","dispose","producer","next","r","done","end","value","event","fromAsyncIterable","Stream","AsyncIterableSource","run","asyncGenerate","f","args","Array","slice","call","arguments","shift","AsyncGenerateSource","apply"],"mappings":";;AAAO,SAASA,gBAAT,CAA2BC,aAA3B,EAA0C;MAC3C,CAACC,OAAOC,aAAZ,EAA2B;UACnB,IAAIC,SAAJ,CAAc,sCAAd,CAAN;;SAEKH,cAAcC,OAAOC,aAArB,GAAP;;;ACJF;;AAEA,AAAe,SAASE,qBAAT,CAAgCF,aAAhC,EAA+CG,IAA/C,EAAqDC,SAArD,EAAgE;OACxEJ,aAAL,GAAqBA,aAArB;OACKG,IAAL,GAAYA,IAAZ;OACKC,SAAL,GAAiBA,SAAjB;OACKC,MAAL,GAAc,IAAd;;MAEIC,OAAO,IAAX;WACSC,GAAT,CAAcC,CAAd,EAAiB;SACVL,IAAL,CAAUM,KAAV,CAAgBH,KAAKF,SAAL,CAAeM,GAAf,EAAhB,EAAsCF,CAAtC;;;UAGMG,OAAR,CAAgB,IAAhB,EAAsBC,IAAtB,CAA2BC,YAA3B,EAAyCC,KAAzC,CAA+CP,GAA/C;;;AAGFL,sBAAsBa,SAAtB,CAAgCC,OAAhC,GAA0C,YAAY;OAC/CX,MAAL,GAAc,KAAd;CADF;;AAIA,SAASQ,YAAT,CAAuBI,QAAvB,EAAiC;SACxBA,SAASjB,aAAT,CAAuBkB,IAAvB,GAA8BN,IAA9B,CAAmC,UAAUO,CAAV,EAAa;QACjDA,EAAEC,IAAN,EAAY;eACDjB,IAAT,CAAckB,GAAd,CAAkBJ,SAASb,SAAT,CAAmBM,GAAnB,EAAlB,EAA4CS,EAAEG,KAA9C;KADF,MAEO;eACInB,IAAT,CAAcoB,KAAd,CAAoBN,SAASb,SAAT,CAAmBM,GAAnB,EAApB,EAA8CS,EAAEG,KAAhD;UACIL,SAASZ,MAAb,EAAqB;eACZQ,aAAaI,QAAb,CAAP;;;GANC,CAAP;;;ACjBK,SAASO,iBAAT,CAA4B1B,aAA5B,EAA2C;SACzC,IAAI2B,MAAJ,CAAW,IAAIC,mBAAJ,CAAwB5B,aAAxB,CAAX,CAAP;;;AAGF,SAAS4B,mBAAT,CAA8B5B,aAA9B,EAA6C;OACtCA,aAAL,GAAqBA,aAArB;;;AAGF4B,oBAAoBX,SAApB,CAA8BY,GAA9B,GAAoC,UAAUxB,IAAV,EAAgBC,SAAhB,EAA2B;MACzDJ,gBAAgBH,iBAAiB,KAAKC,aAAtB,CAApB;SACO,IAAII,qBAAJ,CAA0BF,aAA1B,EAAyCG,IAAzC,EAA+CC,SAA/C,CAAP;CAFF;;ACRA;;;;;AAKA,AAAO,SAASwB,aAAT,CAAwBC,CAAxB,iBAA0C;MAC3CC,OAAOC,MAAMhB,SAAN,CAAgBiB,KAAhB,CAAsBC,IAAtB,CAA2BC,SAA3B,CAAX;OACKC,KAAL;SACO,IAAIV,MAAJ,CAAW,IAAIW,mBAAJ,CAAwBP,CAAxB,EAA2BC,IAA3B,CAAX,CAAP;;;AAGF,SAASM,mBAAT,CAA8BP,CAA9B,EAAiCC,IAAjC,EAAuC;OAChCD,CAAL,GAASA,CAAT;OACKC,IAAL,GAAYA,IAAZ;;;AAGFM,oBAAoBrB,SAApB,CAA8BY,GAA9B,GAAoC,UAAUxB,IAAV,EAAgBC,SAAhB,EAA2B;MACzDN,gBAAgB,KAAK+B,CAAL,CAAOQ,KAAP,CAAa,KAAK,CAAlB,EAAqB,KAAKP,IAA1B,CAApB;MACI9B,gBAAgBH,iBAAiBC,aAAjB,CAApB;SACO,IAAII,qBAAJ,CAA0BF,aAA1B,EAAyCG,IAAzC,EAA+CC,SAA/C,CAAP;CAHF;;ACpBA,yEAEA,AACA;;"}